(function(e){e.fn.linedtextarea=function(t){var n=e.extend({},e.fn.linedtextarea.defaults,t);var r=function(e,t,r){while(e.height()-t<=0){if(r==n.selectedLine)e.append("<div class='lineno lineselect'>"+r+"</div>");else e.append("<div class='lineno'>"+r+"</div>");r++}return r};return this.each(function(){var t=1;var i=e(this);i.attr("wrap","off");i.css({resize:"none"});var s=i.outerWidth();i.wrap("<div class='linedtextarea'></div>");var o=i.parent().wrap("<div class='linedwrap' style='width:"+s+"px'></div>");var u=o.parent();u.prepend("<div class='lines' style='width:50px'></div>");var a=u.find(".lines");a.height(i.height()+6);a.append("<div class='codelines'></div>");var f=a.find(".codelines");t=r(f,a.height(),1);if(n.selectedLine!=-1&&!isNaN(n.selectedLine)){var l=parseInt(i.height()/(t-2));var c=parseInt(l*n.selectedLine)-i.height()/2;i[0].scrollTop=c}var h=a.outerWidth();var p=parseInt(u.css("border-left-width"))+parseInt(u.css("border-right-width"))+parseInt(u.css("padding-left"))+parseInt(u.css("padding-right"));var d=s-p;var v=s-h-p-20;i.width(v);u.width(d);i.scroll(function(n){var i=e(this)[0];var s=i.scrollTop;var o=i.clientHeight;f.css({"margin-top":-1*s+"px"});t=r(f,s+o,t)});i.resize(function(t){var n=e(this)[0];a.height(n.clientHeight+6)})})};e.fn.linedtextarea.defaults={selectedLine:-1,selectedClass:"lineselect"}})(jQuery)